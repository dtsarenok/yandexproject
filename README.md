# Распределённый вычислитель арифметических выражений

Этот проект представляет собой распределённую систему для вычисления арифметических выражений. Она состоит из двух основных компонентов: **оркестратора** и **агента**.

# Компоненты системы

- **Оркестратор**: Это серверная часть, которая принимает арифметические выражения, разбивает их на задачи и отправляет их агентам для выполнения.
- **Агент**: Это демон, который получает задачи от оркестратора, выполняет их и возвращает результаты обратно оркестратору.

# Как работает система

1. **Добавление выражения**: Пользователь отправляет HTTP-запрос на оркестратор с арифметическим выражением.
2. **Разбивка на задачи**: Оркестратор разбивает выражение на отдельные задачи (например, сложение или умножение).
3. **Выполнение задач**: Агенты получают задачи от оркестратора, выполняют их и возвращают результаты.
4. **Обновление результата**: Оркестратор получает результаты от агентов и обновляет статус выражения.

# Команды для запуска

# 1. Запуск оркестратора

Чтобы запустить оркестратор, используйте команду:

go run ./cmd/calc_service/main.go

Эта команда запустит сервер на порту 8080.

# 2. Запуск агента

Агент запускается автоматически из `main.go`, но если вы хотите запустить его отдельно, используйте команду:

go run ./internal/agent/agent.go

# 3. Установка переменных окружения

Чтобы задать время выполнения операций, используйте команду:

TIME_ADDITION_MS=1000 TIME_SUBTRACTION_MS=1000 TIME_MULTIPLICATIONS_MS=1000 TIME_DIVISIONS_MS=1000 go run ./cmd/calc_service/main.go


# 4. Примеры запросов

# Добавление выражения

curl --location 'http://localhost:8080/api/v1/calculate'
--header 'Content-Type: application/json'
--data '{
"expression": "2+2",
"id": "test-id"
}'


# Получение списка выражений

curl --location 'http://localhost:8080/api/v1/expressions'


# Получение выражения по ID

curl --location 'http://localhost:8080/api/v1/expressions/test-id'


#### Получение задачи агентом

curl --location 'http://localhost:8080/internal/task'


#### Отправка результата агентом

curl --location 'http://localhost:8080/internal/task'
--header 'Content-Type: application/json'
--data '{
"id": "test-id",
"result": 4.0
}'


## Тестирование

Чтобы запустить тесты, используйте команду:

go test -v
